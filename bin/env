#!/usr/bin/env bash

SECRET=$(kubectl -n argo get sa gitea -o=jsonpath='{.secrets[0].name}')

function argo-event() {
    echo "arg: $1"
    DEFAULT_MESSAGE='{"message": "hi"}'
    curl $ARGO_URL/api/v1/events/argo/ \
        -H "Authorization: Bearer $ARGO_TOKEN" \
        -d "${1:-$DEFAULT_MESSAGE}" \
        -v
}

# ARGO_URL=$(kubectl -n argo get svc -lapp.kubernetes.io/name=argo-workflows-server -o json | jq '.items[].status.loadBalancer.ingress[].ip' -r)
# echo Argo URL: http://${ARGO_URL}:2746/

KONG_URL=$(kubectl -n kong get svc -lapp.kubernetes.io/instance=kong -o json | jq '.items[].status.loadBalancer.ingress[].ip' -r)
echo Kong URL: http://${KONG_URL}

# GITEA_URL=$(kubectl -n gitea get svc gitea-http -o json | jq '.status.loadBalancer.ingress[].ip' -r)
# echo GITEA URL: http://${GITEA_URL}:3000/